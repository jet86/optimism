"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getGovernorBravoValue = exports.governorBravoFetchers = exports.getGovernorV = void 0;
const CoreValue_1 = require("../CoreValue");
const Value_1 = require("../Value");
const Command_1 = require("../Command");
const BravoProposalValue_1 = require("./BravoProposalValue");
const ContractLookup_1 = require("../ContractLookup");
async function getGovernorV(world, event) {
    const address = await CoreValue_1.mapValue(world, event, (str) => new Value_1.AddressV(ContractLookup_1.getGovernorAddress(world, str)), CoreValue_1.getCoreValue, Value_1.AddressV);
    return ContractLookup_1.getWorldContractByAddress(world, address.val);
}
exports.getGovernorV = getGovernorV;
async function governorAddress(world, governor) {
    return new Value_1.AddressV(governor._address);
}
async function getAdmin(world, governor) {
    return new Value_1.AddressV(await governor.methods.admin().call());
}
async function getPendingAdmin(world, governor) {
    return new Value_1.AddressV(await governor.methods.pendingAdmin().call());
}
async function getImplementation(world, governor) {
    return new Value_1.AddressV(await governor.methods.implementation().call());
}
async function getProposalThreshold(world, governor) {
    return new Value_1.NumberV(await governor.methods.proposalThreshold().call());
}
async function getVotingPeriod(world, governor) {
    return new Value_1.NumberV(await governor.methods.votingPeriod().call());
}
async function getVotingDelay(world, governor) {
    return new Value_1.NumberV(await governor.methods.votingDelay().call());
}
function governorBravoFetchers() {
    return [
        new Command_1.Fetcher(`
        #### Address

        * "GovernorBravo <GovernorBravo> Address" - Returns the address of governorBravo contract
        * E.g. "GovernorBravo GovernorBravoScenario Address"
      `, "Address", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => governorAddress(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Admin

        * "GovernorBravo <Governor> Admin" - Returns the address of governorBravo admin
        * E.g. "GovernorBravo GovernorBravoScenario Admin"
      `, "Admin", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getAdmin(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Pending Admin

        * "GovernorBravo <Governor> PendingAdmin" - Returns the address of governorBravo pending admin
        * E.g. "GovernorBravo GovernorBravoScenario PendingAdmin"
      `, "PendingAdmin", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getPendingAdmin(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Implementation

        * "GovernorBravo <Governor> Implementation" - Returns the address of governorBravo implementation
        * E.g. "GovernorBravo GovernorBravoScenario Implementation"
      `, "Implementation", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getImplementation(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### ProposalThreshold

        * "GovernorBravo <Governor> ProposalThreshold" - Returns the proposal threshold of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario ProposalThreshold"
      `, "ProposalThreshold", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getProposalThreshold(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### VotingPeriod

        * "GovernorBravo <Governor> VotingPeriod" - Returns the voting period of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario VotingPeriod"
      `, "VotingPeriod", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getVotingPeriod(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### VotingDelay

        * "GovernorBravo <Governor> VotingDelay" - Returns the voting delay of the given governorBravo 
        * E.g. "GovernorBravo GovernorBravoScenario VotingDelay"
      `, "VotingDelay", [new Command_1.Arg("governor", getGovernorV)], (world, { governor }) => getVotingDelay(world, governor), { namePos: 1 }),
        new Command_1.Fetcher(`
        #### Proposal

        * "GovernorBravo <Governor> Proposal <...proposalValue>" - Returns information about a proposal
        * E.g. "GovernorBravo GovernorBravoScenario Proposal LastProposal Id"
      `, "Proposal", [
            new Command_1.Arg("governor", getGovernorV),
            new Command_1.Arg("params", CoreValue_1.getEventV, { variadic: true }),
        ], (world, { governor, params }) => BravoProposalValue_1.getProposalValue(world, governor, params.val), { namePos: 1 }),
    ];
}
exports.governorBravoFetchers = governorBravoFetchers;
async function getGovernorBravoValue(world, event) {
    return await Command_1.getFetcherValue("GovernorBravo", governorBravoFetchers(), world, event);
}
exports.getGovernorBravoValue = getGovernorBravoValue;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR292ZXJub3JCcmF2b1ZhbHVlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL1ZhbHVlL0dvdmVybm9yQnJhdm9WYWx1ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFHQSw0Q0FBaUU7QUFDakUsb0NBQTREO0FBQzVELHdDQUEyRDtBQUMzRCw2REFBd0Q7QUFDeEQsc0RBRzJCO0FBRXBCLEtBQUssVUFBVSxZQUFZLENBQ2hDLEtBQVksRUFDWixLQUFZO0lBRVosTUFBTSxPQUFPLEdBQUcsTUFBTSxvQkFBUSxDQUM1QixLQUFLLEVBQ0wsS0FBSyxFQUNMLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxJQUFJLGdCQUFRLENBQUMsbUNBQWtCLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQ3JELHdCQUFZLEVBQ1osZ0JBQVEsQ0FDVCxDQUFDO0lBRUYsT0FBTywwQ0FBeUIsQ0FBZ0IsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUN0RSxDQUFDO0FBYkQsb0NBYUM7QUFFRCxLQUFLLFVBQVUsZUFBZSxDQUM1QixLQUFZLEVBQ1osUUFBdUI7SUFFdkIsT0FBTyxJQUFJLGdCQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxLQUFLLFVBQVUsUUFBUSxDQUNyQixLQUFZLEVBQ1osUUFBdUI7SUFFdkIsT0FBTyxJQUFJLGdCQUFRLENBQUMsTUFBTSxRQUFRLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7QUFDN0QsQ0FBQztBQUVELEtBQUssVUFBVSxlQUFlLENBQzVCLEtBQVksRUFDWixRQUF1QjtJQUV2QixPQUFPLElBQUksZ0JBQVEsQ0FBQyxNQUFNLFFBQVEsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUNwRSxDQUFDO0FBRUQsS0FBSyxVQUFVLGlCQUFpQixD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LEVBQUUsQ0FBQyxFQUFFLENBQ2Y7UUFFRCxJQUFJLGlCQUFPLENBQ1Q7Ozs7O09BS0MsRUFDRCxhQUFhLEVBQ2IsQ0FBQyxJQUFJLGFBQUcsQ0FBQyxVQUFVLEVBQUUsWUFBWSxDQUFDLENBQUMsRUFDbkMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsRUFDeEQsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQ2Y7UUFFRCxJQUFJLGlCQUFPLENBQ1Q7Ozs7O09BS0MsRUFDRCxVQUFVLEVBQ1Y7WUFDRSxJQUFJLGFBQUcsQ0FBQyxVQUFVLEVBQUUsWUFBWSxDQUFDO1lBQ2pDLElBQUksYUFBRyxDQUFDLFFBQVEsRUFBRSxxQkFBUyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDO1NBQ2pELEVBQ0QsQ0FBQyxLQUFLLEVBQUUsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUM5QixxQ0FBZ0IsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFDL0MsRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQ2Y7S0FDRixDQUFDO0FBQ0osQ0FBQztBQTlHRCxzREE4R0M7QUFFTSxLQUFLLFVBQVUscUJBQXFCLENBQ3pDLEtBQVksRUFDWixLQUFZO0lBRVosT0FBTyxNQUFNLHlCQUFlLENBQzFCLGVBQWUsRUFDZixxQkFBcUIsRUFBRSxFQUN2QixLQUFLLEVBQ0wsS0FBSyxDQUNOLENBQUM7QUFDSixDQUFDO0FBVkQsc0RBVUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFdmVudCB9IGZyb20gXCIuLi9FdmVudFwiO1xuaW1wb3J0IHsgV29ybGQgfSBmcm9tIFwiLi4vV29ybGRcIjtcbmltcG9ydCB7IEdvdmVybm9yQnJhdm8gfSBmcm9tIFwiLi4vQ29udHJhY3QvR292ZXJub3JCcmF2b1wiO1xuaW1wb3J0IHsgZ2V0Q29yZVZhbHVlLCBnZXRFdmVudFYsIG1hcFZhbHVlIH0gZnJvbSBcIi4uL0NvcmVWYWx1ZVwiO1xuaW1wb3J0IHsgQWRkcmVzc1YsIE51bWJlclYsIEV2ZW50ViwgVmFsdWUgfSBmcm9tIFwiLi4vVmFsdWVcIjtcbmltcG9ydCB7IEFyZywgRmV0Y2hlciwgZ2V0RmV0Y2hlclZhbHVlIH0gZnJvbSBcIi4uL0NvbW1hbmRcIjtcbmltcG9ydCB7IGdldFByb3Bvc2FsVmFsdWUgfSBmcm9tIFwiLi9CcmF2b1Byb3Bvc2FsVmFsdWVcIjtcbmltcG9ydCB7XG4gIGdldEdvdmVybm9yQWRkcmVzcyxcbiAgZ2V0V29ybGRDb250cmFjdEJ5QWRkcmVzcyxcbn0gZnJvbSBcIi4uL0NvbnRyYWN0TG9va3VwXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRHb3Zlcm5vclYoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZXZlbnQ6IEV2ZW50XG4pOiBQcm9taXNlPEdvdmVybm9yQnJhdm8+IHtcbiAgY29uc3QgYWRkcmVzcyA9IGF3YWl0IG1hcFZhbHVlPEFkZHJlc3NWPihcbiAgICB3b3JsZCxcbiAgICBldmVudCxcbiAgICAoc3RyKSA9PiBuZXcgQWRkcmVzc1YoZ2V0R292ZXJub3JBZGRyZXNzKHdvcmxkLCBzdHIpKSxcbiAgICBnZXRDb3JlVmFsdWUsXG4gICAgQWRkcmVzc1ZcbiAgKTtcblxuICByZXR1cm4gZ2V0V29ybGRDb250cmFjdEJ5QWRkcmVzczxHb3Zlcm5vckJyYXZvPih3b3JsZCwgYWRkcmVzcy52YWwpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnb3Zlcm5vckFkZHJlc3MoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8QWRkcmVzc1Y+IHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzVihnb3Zlcm5vci5fYWRkcmVzcyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEFkbWluKFxuICB3b3JsZDogV29ybGQsXG4gIGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvXG4pOiBQcm9taXNlPEFkZHJlc3NWPiB7XG4gIHJldHVybiBuZXcgQWRkcmVzc1YoYXdhaXQgZ292ZXJub3IubWV0aG9kcy5hZG1pbigpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFBlbmRpbmdBZG1pbihcbiAgd29ybGQ6IFdvcmxkLFxuICBnb3Zlcm5vcjogR292ZXJub3JCcmF2b1xuKTogUHJvbWlzZTxBZGRyZXNzVj4ge1xuICByZXR1cm4gbmV3IEFkZHJlc3NWKGF3YWl0IGdvdmVybm9yLm1ldGhvZHMucGVuZGluZ0FkbWluKCkuY2FsbCgpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0SW1wbGVtZW50YXRpb24oXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8QWRkcmVzc1Y+IHtcbiAgcmV0dXJuIG5ldyBBZGRyZXNzVihhd2FpdCBnb3Zlcm5vci5tZXRob2RzLmltcGxlbWVudGF0aW9uKCkuY2FsbCgpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvcG9zYWxUaHJlc2hvbGQoXG4gIHdvcmxkOiBXb3JsZCxcbiAgZ292ZXJub3I6IEdvdmVybm9yQnJhdm9cbik6IFByb21pc2U8TnVtYmVyVj4ge1xuICByZXR1cm4gbmV3IE51bWJlclYoYXdhaXQgZ292ZXJub3IubWV0aG9kcy5wcm9wb3NhbFRocmVzaG9sZCgpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFZvdGluZ1BlcmlvZChcbiAgd29ybGQ6IFdvcmxkLFxuICBnb3Zlcm5vcjogR292ZXJub3JCcmF2b1xuKTogUHJvbWlzZTxOdW1iZXJWPiB7XG4gIHJldHVybiBuZXcgTnVtYmVyVihhd2FpdCBnb3Zlcm5vci5tZXRob2RzLnZvdGluZ1BlcmlvZCgpLmNhbGwoKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFZvdGluZ0RlbGF5KFxuICB3b3JsZDogV29ybGQsXG4gIGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvXG4pOiBQcm9taXNlPE51bWJlclY+IHtcbiAgcmV0dXJuIG5ldyBOdW1iZXJWKGF3YWl0IGdvdmVybm9yLm1ldGhvZHMudm90aW5nRGVsYXkoKS5jYWxsKCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ292ZXJub3JCcmF2b0ZldGNoZXJzKCkge1xuICByZXR1cm4gW1xuICAgIG5ldyBGZXRjaGVyPHsgZ292ZXJub3I6IEdvdmVybm9yQnJhdm8gfSwgQWRkcmVzc1Y+KFxuICAgICAgYFxuICAgICAgICAjIyMjIEFkZHJlc3NcblxuICAgICAgICAqIFwiR292ZXJub3JCcmF2byA8R292ZXJub3JCcmF2bz4gQWRkcmVzc1wiIC0gUmV0dXJucyB0aGUgYWRkcmVzcyBvZiBnb3Zlcm5vckJyYXZvIGNvbnRyYWN0XG4gICAgICAgICogRS5nLiBcIkdvdmVybm9yQnJhdm8gR292ZXJub3JCcmF2b1NjZW5hcmlvIEFkZHJlc3NcIlxuICAgICAgYCxcbiAgICAgIFwiQWRkcmVzc1wiLFxuICAgICAgW25ldyBBcmcoXCJnb3Zlcm5vclwiLCBnZXRHb3Zlcm5vclYpXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciB9KSA9PiBnb3Zlcm5vckFkZHJlc3Mod29ybGQsIGdvdmVybm9yKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBGZXRjaGVyPHsgZ292ZXJub3I6IEdvdmVybm9yQnJhdm8gfSwgQWRkcmVzc1Y+KFxuICAgICAgYFxuICAgICAgICAjIyMjIEFkbWluXG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yPiBBZG1pblwiIC0gUmV0dXJucyB0aGUgYWRkcmVzcyBvZiBnb3Zlcm5vckJyYXZvIGFkbWluXG4gICAgICAgICogRS5nLiBcIkdvdmVybm9yQnJhdm8gR292ZXJub3JCcmF2b1NjZW5hcmlvIEFkbWluXCJcbiAgICAgIGAsXG4gICAgICBcIkFkbWluXCIsXG4gICAgICBbbmV3IEFyZyhcImdvdmVybm9yXCIsIGdldEdvdmVybm9yVildLFxuICAgICAgKHdvcmxkLCB7IGdvdmVybm9yIH0pID0+IGdldEFkbWluKHdvcmxkLCBnb3Zlcm5vciksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBQZW5kaW5nIEFkbWluXG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yPiBQZW5kaW5nQWRtaW5cIiAtIFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgZ292ZXJub3JCcmF2byBwZW5kaW5nIGFkbWluXG4gICAgICAgICogRS5nLiBcIkdvdmVybm9yQnJhdm8gR292ZXJub3JCcmF2b1NjZW5hcmlvIFBlbmRpbmdBZG1pblwiXG4gICAgICBgLFxuICAgICAgXCJQZW5kaW5nQWRtaW5cIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ2V0UGVuZGluZ0FkbWluKHdvcmxkLCBnb3Zlcm5vciksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIEFkZHJlc3NWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBJbXBsZW1lbnRhdGlvblxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gSW1wbGVtZW50YXRpb25cIiAtIFJldHVybnMgdGhlIGFkZHJlc3Mgb2YgZ292ZXJub3JCcmF2byBpbXBsZW1lbnRhdGlvblxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBJbXBsZW1lbnRhdGlvblwiXG4gICAgICBgLFxuICAgICAgXCJJbXBsZW1lbnRhdGlvblwiLFxuICAgICAgW25ldyBBcmcoXCJnb3Zlcm5vclwiLCBnZXRHb3Zlcm5vclYpXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciB9KSA9PiBnZXRJbXBsZW1lbnRhdGlvbih3b3JsZCwgZ292ZXJub3IpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuXG4gICAgbmV3IEZldGNoZXI8eyBnb3Zlcm5vcjogR292ZXJub3JCcmF2byB9LCBOdW1iZXJWPihcbiAgICAgIGBcbiAgICAgICAgIyMjIyBQcm9wb3NhbFRocmVzaG9sZFxuXG4gICAgICAgICogXCJHb3Zlcm5vckJyYXZvIDxHb3Zlcm5vcj4gUHJvcG9zYWxUaHJlc2hvbGRcIiAtIFJldHVybnMgdGhlIHByb3Bvc2FsIHRocmVzaG9sZCBvZiB0aGUgZ2l2ZW4gZ292ZXJub3JCcmF2byBcbiAgICAgICAgKiBFLmcuIFwiR292ZXJub3JCcmF2byBHb3Zlcm5vckJyYXZvU2NlbmFyaW8gUHJvcG9zYWxUaHJlc2hvbGRcIlxuICAgICAgYCxcbiAgICAgIFwiUHJvcG9zYWxUaHJlc2hvbGRcIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ2V0UHJvcG9zYWxUaHJlc2hvbGQod29ybGQsIGdvdmVybm9yKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcblxuICAgIG5ldyBGZXRjaGVyPHsgZ292ZXJub3I6IEdvdmVybm9yQnJhdm8gfSwgTnVtYmVyVj4oXG4gICAgICBgXG4gICAgICAgICMjIyMgVm90aW5nUGVyaW9kXG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yPiBWb3RpbmdQZXJpb2RcIiAtIFJldHVybnMgdGhlIHZvdGluZyBwZXJpb2Qgb2YgdGhlIGdpdmVuIGdvdmVybm9yQnJhdm8gXG4gICAgICAgICogRS5nLiBcIkdvdmVybm9yQnJhdm8gR292ZXJub3JCcmF2b1NjZW5hcmlvIFZvdGluZ1BlcmlvZFwiXG4gICAgICBgLFxuICAgICAgXCJWb3RpbmdQZXJpb2RcIixcbiAgICAgIFtuZXcgQXJnKFwiZ292ZXJub3JcIiwgZ2V0R292ZXJub3JWKV0sXG4gICAgICAod29ybGQsIHsgZ292ZXJub3IgfSkgPT4gZ2V0Vm90aW5nUGVyaW9kKHdvcmxkLCBnb3Zlcm5vciksXG4gICAgICB7IG5hbWVQb3M6IDEgfVxuICAgICksXG5cbiAgICBuZXcgRmV0Y2hlcjx7IGdvdmVybm9yOiBHb3Zlcm5vckJyYXZvIH0sIE51bWJlclY+KFxuICAgICAgYFxuICAgICAgICAjIyMjIFZvdGluZ0RlbGF5XG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yPiBWb3RpbmdEZWxheVwiIC0gUmV0dXJucyB0aGUgdm90aW5nIGRlbGF5IG9mIHRoZSBnaXZlbiBnb3Zlcm5vckJyYXZvIFxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBWb3RpbmdEZWxheVwiXG4gICAgICBgLFxuICAgICAgXCJWb3RpbmdEZWxheVwiLFxuICAgICAgW25ldyBBcmcoXCJnb3Zlcm5vclwiLCBnZXRHb3Zlcm5vclYpXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciB9KSA9PiBnZXRWb3RpbmdEZWxheSh3b3JsZCwgZ292ZXJub3IpLFxuICAgICAgeyBuYW1lUG9zOiAxIH1cbiAgICApLFxuXG4gICAgbmV3IEZldGNoZXI8eyBnb3Zlcm5vcjogR292ZXJub3JCcmF2bzsgcGFyYW1zOiBFdmVudFYgfSwgVmFsdWU+KFxuICAgICAgYFxuICAgICAgICAjIyMjIFByb3Bvc2FsXG5cbiAgICAgICAgKiBcIkdvdmVybm9yQnJhdm8gPEdvdmVybm9yPiBQcm9wb3NhbCA8Li4ucHJvcG9zYWxWYWx1ZT5cIiAtIFJldHVybnMgaW5mb3JtYXRpb24gYWJvdXQgYSBwcm9wb3NhbFxuICAgICAgICAqIEUuZy4gXCJHb3Zlcm5vckJyYXZvIEdvdmVybm9yQnJhdm9TY2VuYXJpbyBQcm9wb3NhbCBMYXN0UHJvcG9zYWwgSWRcIlxuICAgICAgYCxcbiAgICAgIFwiUHJvcG9zYWxcIixcbiAgICAgIFtcbiAgICAgICAgbmV3IEFyZyhcImdvdmVybm9yXCIsIGdldEdvdmVybm9yViksXG4gICAgICAgIG5ldyBBcmcoXCJwYXJhbXNcIiwgZ2V0RXZlbnRWLCB7IHZhcmlhZGljOiB0cnVlIH0pLFxuICAgICAgXSxcbiAgICAgICh3b3JsZCwgeyBnb3Zlcm5vciwgcGFyYW1zIH0pID0+XG4gICAgICAgIGdldFByb3Bvc2FsVmFsdWUod29ybGQsIGdvdmVybm9yLCBwYXJhbXMudmFsKSxcbiAgICAgIHsgbmFtZVBvczogMSB9XG4gICAgKSxcbiAgXTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEdvdmVybm9yQnJhdm9WYWx1ZShcbiAgd29ybGQ6IFdvcmxkLFxuICBldmVudDogRXZlbnRcbik6IFByb21pc2U8VmFsdWU+IHtcbiAgcmV0dXJuIGF3YWl0IGdldEZldGNoZXJWYWx1ZTxhbnksIGFueT4oXG4gICAgXCJHb3Zlcm5vckJyYXZvXCIsXG4gICAgZ292ZXJub3JCcmF2b0ZldGNoZXJzKCksXG4gICAgd29ybGQsXG4gICAgZXZlbnRcbiAgKTtcbn1cbiJdfQ==